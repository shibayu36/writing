# QAフローを最適化し、品質水準を満たしながらリリースまでの期間を最短化する

こんにちは、クラスター株式会社でソフトウェアエンジニアをやっている柴田です。

QAフローが大変で開発したもののリリースに時間がかかってしまうという悩みはありませんか？

クラスター株式会社では障害を最小に抑えるため厚いQAフローを運用していました。このフローによってサービスの可用性品質は非常に高い一方で、開発を終えたものをリリースするまで最低でも10日かかるという課題がありました。

ソフトウェアエンジニアの立場からこの課題を解決するため、障害数をコントロールした上でリリースまでの期間を最短化する方法を模索・提案し、改善を進めました。この改善の結果、以前は開発終了からリリースまで10日必要だったものが、今は最短で5日ほどでリリースできるようになりました。さらに新しいフローになった後も、顕著な障害増加はなく、可用性品質をコントロールできている状況を作り出せました。

本記事では、QAフローの運用を最適化した具体的な経験を紹介します。

[:contents]

## これまでの課題

まず、改善前にどのような課題があったかを説明します。

クラスターでは、メタバース「cluster」というサービスを提供しています。clusterでは企業と一緒に大規模イベントを開催することも多く、イベント中に障害が起きると大きな影響が出てしまいます。そのため、障害を最小に抑えることを最優先として、非常に厚いQAフローを運用していました。

具体的には、以下のようなQAプロセスを実施していました：

- **Regressionテスト**：アプリの主要機能が全て動作するかを確認する包括的なテスト
- **Epic QA**：新規開発した機能について詳細にテストを行う
- **バグ修正確認**：修正したバグが正しく直っているかを確認

これらのQAは全てQAグループのメンバーが実施し、非常に緻密にテストを行っていました。

（ここに元々のQAフローの図を入れること）

このQAフローによって、サービスの可用性品質は非常に高く保たれていました。しかし一方で、開発が終わってからリリースまでに最低でも10日、場合によっては2週間近くかかるという課題がありました。

この長いリリースサイクルによって、以下のような問題が起きていました：

- **作ったものをユーザーに早く届けられない**：開発完了から10日以上経たないとユーザーに機能を届けられない
- **問題修正に時間がかかる**：あるリリースでバグが発覚しても、それを直してリリースするまで2週間かかってしまう

そこで、障害数はコントロールした上で、リリースまでの期間を短縮化し、作ったものを早く届けられるように、起きた問題を素早く修正できるようにしたいと考えました。

## 改善後のフロー（最終形）

改善の詳細を説明する前に、まず最終的にどのようなフローになったかを先にお見せします。

（ここに改善後のQAフローの図を入れること）

最終的には以下のような流れになりました：

1. **Dev Bug Bash（開発中）**：開発者が開発中に自分でテストを行い、早期にバグを発見
2. **木曜日に2時間で一斉QA**：開発チーム全員で、QAメンバーが作成したテストケースを使って集中的にテスト
3. **月曜日リリース**：テスト完了後、週明けにリリース

このフローによって、開発完了から最短で5日程度でリリースできるようになりました。

では、どのようにしてこのフローに辿り着いたのか、具体的に説明していきます。

## 元々の開発フローの背景

改善を進めるにあたって、まず元々のフローがどのようなものだったかを詳しく理解する必要がありました。

### QAプロセスの詳細

元々のQAフローでは、以下の3つのテストを実施していました：

**1. Regressionテスト**
アプリの主要機能が全て動作するかを確認する包括的なテストです。約XX項目のテストケースがあり、QAメンバーが1つ1つ手動で確認していました。このテストだけで約X日かかっていました。

**2. Epic QA**
新規開発した機能について、仕様通りに動作するか、様々な端末で問題がないか、エッジケースでの挙動などを詳細にテストします。開発規模によって異なりますが、大きな機能の場合X日程度かかることもありました。

**3. バグ修正確認**
過去のリリースで見つかったバグの修正が正しく行われているかを確認します。

これら全てをQAグループのメンバーが実施していたため、QAグループのリソースが常にひっ迫している状態でした。

### リリースサイクル

当時のリリースサイクルは以下のような流れでした：

1. 開発完了
2. Regressionテスト（X日）
3. Epic QA（X日）
4. バグ修正とその確認（X日）
5. リリース

これらを全て直列で実行していたため、最短でも10日、長い場合は2週間以上かかっていました。

（ここに元々のリリースサイクルのタイムラインを入れること）

## 改善の方針

QAフローを最適化するにあたって、以下の方針を立てました。

### 基本方針

**サービスとしてのQAは開発チームが行い、コンテンツのQAはQAグループが行う**

clusterというサービスには2つの品質側面がありました：

1. **サービスとしての品質**：ログイン機能、ワールド移動、音声通話など、サービスの基本機能が正しく動作するか
2. **コンテンツの品質**：ワールド内のコンテンツが適切か、イベントの演出が意図通りか

このうち、サービスとしての品質については、QAメンバーと相談して良いテストケースを決めた上で、開発チームが自らテストを行うことにしました。これによって以下の効果を狙いました：

- QAグループのリソースを解放し、コンテンツQAに集中できるようにする
- 開発チームがテストを行うことで、品質への意識が高まる
- QAの待ち時間を削減し、リリースサイクルを短縮できる

### 達成したい品質基準を決める

最適化を進める上で、まず「どの品質水準を保つべきか」を明確にする必要がありました。

事業の特性を理解した結果、以下の基準を設定しました：

**「企業と一緒に行うイベントでの複数人での同期的体験が担保できている状態」を最低水準とする**

具体的には：
- イベント参加者が正常にワールドに入れる
- 音声通話が正常に動作する
- 基本的な移動や操作ができる
- イベント演出が意図通りに動作する

一方で、以下のような問題については「発生しても許容範囲内」と判断しました：
- 特定の端末やOSバージョンでのみ発生するマイナーなバグ
- 使用頻度の低い機能での軽微な不具合

この基準を明確にすることで、どこまでテストすべきか、どこを省略できるかの判断軸ができました。

## 実施したこと

方針が決まったところで、具体的に以下のステップで改善を進めました。

### 1. 制約条件の理解

まず、変更できない制約条件を整理しました：

- **リリース曜日は月曜日が望ましい**：週の始まりにリリースすることで、問題が起きた時に週内で対応できる
- **iOSの審査は24時間程度見ておく必要がある**：App Store審査の時間を考慮する必要がある
- **大きな変更は一度にできない**：QAグループから開発チームへのやり方の引き継ぎが必要なため、段階的に進める必要がある

これらの制約を踏まえて、フローを設計する必要がありました。

### 2. 開発フロー案の再設計

制約条件と品質基準を満たすように、以下のような新しいフローを設計しました：

**木曜日に2時間で一斉QA から 月曜日リリース**

このフローにした理由：
- 木曜日にQAを実施することで、金曜日にバグ修正ができる
- 土日を挟むことでiOS審査の時間も確保できる
- 月曜日リリースで、問題があっても週内に対応できる

また、開発中にも以下を実施：
- **Dev Bug Bash**：開発者が自分で早期にテストを行い、バグを見つける

（ここに新しいフローのタイムラインを入れること）

このフローによって、開発完了から最短で5日程度でリリースできるようになります。

### 3. Regressionテストケースの再設計

次に、QAメンバーと一緒にRegressionテストケースの見直しを行いました。

**見直しのプロセス：**

1. 既存のXX項目のテストケースを全て洗い出す
2. 各テストケースについて、「達成したい品質基準」のためにどれだけ重要かを評価
3. 重要度の高いテストケースを厳選し、約YY項目に絞り込む
4. テストケースを開発者でも実施できるように、手順を明確化

この作業をQAメンバーと一緒に行ったことで、QAの専門知識を活かしながら、開発者でも実施可能なテストケースを作ることができました。

実際に絞り込んだテストケースの例：
- ログイン機能の確認
- ワールド移動の確認
- 音声通話の確認
- 基本的な操作（移動、ジャンプなど）の確認
- イベント機能の基本動作確認

（ここにテストケースの例を示す表やスクリーンショットを入れること）

### 4. Epic QAとバグ修正確認の開発チーム化

Epic QAとバグ修正確認についても、開発チームで実施するように変更しました。

**新しいやり方：**

- 開発した人が、どのような機能・修正を行ったかをドキュメントにまとめる
- ドキュメントには、テストすべきポイントも記載する
- 他の開発メンバーが、そのドキュメントを見てテストを実施
- レビュー形式で、開発者以外の目でも品質を確認

このやり方により：
- 開発者が自分の実装に責任を持つようになった
- 他のメンバーがコードレビューと合わせてQAもできるようになった
- QA待ちの時間がなくなった

### 5. 移行計画の作成と実施

いきなり全てを変更すると混乱が生じるため、段階的に移行する計画を立てました。

**移行のステップ：**

1. **ステップ1（1ヶ月目）**：Regressionテストとバグ修正確認を開発チームに移管
   - QAメンバーが立ち会いながら、開発チームがテストを実施
   - テストのやり方を学ぶ期間
   - 2-3回のリリースで慣れる

2. **ステップ2（2ヶ月目）**：Epic QAを開発チームに移管
   - ドキュメントの書き方やテストの進め方を確立
   - QAメンバーはレビューに徹する

3. **ステップ3（3ヶ月目）**：リリースサイクルの短縮
   - 開発チームが慣れてきたタイミングで、木曜QAから月曜リリースのフローに移行

この段階的なアプローチによって、開発チームが新しいやり方に慣れながら、品質を保つことができました。

## 結果

3ヶ月かけて移行を完了し、以下のような結果が得られました。

### リリースサイクルの短縮

開発完了からリリースまでの期間が、**10日から最短5日**に短縮されました。

（ここに改善前後の比較図を入れること）

これにより：
- **作ったものを早く届けられる**：開発完了から5日でユーザーに届けられる
- **問題修正が素早くできる**：バグ修正から5日でリリースできる

### 品質の維持

QAフローを最適化した後も、顕著な障害増加は起こっていません。

（ここに障害発生数の推移グラフを入れること）

特に：
- サービス完全ダウンは発生していない
- 特定機能が全く使えないなどのクリティカルな問題も起きていない
- イベント中の大きな障害も発生していない

達成したい品質基準である「企業と一緒に行うイベントでの複数人での同期的体験」は、しっかりとコントロールできている状況を維持できています。

### 副次的な効果

QAフローの最適化によって、以下のような副次的な効果も得られました：

**開発チームの品質意識の向上**
- 自分たちでテストを行うようになったことで、品質への責任感が高まった
- テストケースを意識した実装を行うようになった

**QAグループのリソース最適化**
- サービスQAから解放され、コンテンツQAに集中できるようになった
- より価値の高いQA活動に時間を使えるようになった

**開発プロセスの透明性向上**
- Epic QAのドキュメント化によって、実装内容が明確になった
- 他のメンバーも機能の詳細を理解しやすくなった

## まとめ

本記事では、QAフローを最適化し、品質水準を満たしながらリリースまでの期間を最短化した取り組みを紹介しました。

改善を進める上で重要だったポイントは以下の通りです：

1. **達成したい品質基準を明確にする**：事業の特性を理解し、「守るべき品質」と「許容できる範囲」を定義する
2. **制約条件を理解する**：変更できないものを把握した上で、フローを設計する
3. **段階的に移行する**：いきなり全てを変えるのではなく、チームが慣れるための時間を取る
4. **QAメンバーと協力する**：QAの専門知識を活かしながら、開発チームができるテストケースを作る

この取り組みによって、リリースサイクルを10日から5日に短縮しながら、品質を維持することができました。

QAフローに時間がかかりすぎている、もしくはこれからQAフローを始めたいという方の参考になれば幸いです。

---

クラスター株式会社では、このようなプロセス改善に興味のあるエンジニアを募集しています。ご興味のある方は、ぜひ採用ページをご覧ください。

[https://corp.cluster.mu/recruit:title]
