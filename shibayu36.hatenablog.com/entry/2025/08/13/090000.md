---
Title: Daily Do 1.3.0でTODO追加&完了時に触覚フィードバックを追加しました & 実現方法の紹介
Category:
- tech
- Daily Do
Date: 2025-08-13T09:00:00+09:00
URL: https://blog.shibayu36.org/entry/2025/08/13/090000
EditURL: https://blog.hatena.ne.jp/shiba_yu36/shibayu36.hatenablog.com/atom/entry/6802418398539804853
---

Daily Do 1.3.0で触覚フィードバックを追加して、操作感を向上させました。

[Daily Do](https://blog.shibayu36.org/entry/2025/08/06/173000)の1.3.0でTODO追加時と完了時に触覚フィードバックを追加しました。これにより操作の手応えを感じられるようになり気持ちよく操作できるようになるといいなと思います。

<span style="display:inline-block; border:1px solid #ccc; padding:2px;">
[f:id:shiba_yu36:20250804085241p:plain:w500]
</span>

<a href="https://apps.apple.com/jp/app/id6747943242" target="_blank" rel="noopener noreferrer">
  <img
    src="https://tools.applemediaservices.com/api/badges/download-on-the-app-store/black/ja-jp?size=250x83"
    alt="Download on the App Store" style="height:44px">
</a>

### 実現方法

SwiftUIの`sensoryFeedback`モディファイアを使って実装した。iOS 17以降の機能で、UIKitに依存しない純粋なSwiftUI実装が簡単にできるのが良い。

**TODO追加時の振動実装**

```swift
struct TodoListView: View {
  @State private var triggerAddFeedback = false  // TODO追加時の振動フィードバックトリガー
  
  var body: some View {
    VStack {
      // 入力欄のUI
    }
    .background(.regularMaterial)
    .sensoryFeedback(.selection, trigger: triggerAddFeedback) // triggerAddFeedbackの値を変えることで振動を発生させる
  }
  
  private func addItem() {
    viewModel.addTodo(content: newItemText)
    newItemText = ""
    triggerAddFeedback.toggle() // TODO追加時の振動を発生させる
  }
}
```

TODO追加時は、`triggerAddFeedback`というState変数を用意して、TODO追加のタイミングでtoggleしている。`sensoryFeedback`モディファイアは、triggerの値が変化した時に振動するので、この仕組みで実現できる。

**TODO完了時の振動実装**

```swift
struct TodoRowView: View {
  let item: TodoItem
  
  var body: some View {
    HStack {
      // TODOの表示UI
    }
    .sensoryFeedback(.success, trigger: item.isCompleted) { oldValue, newValue in
      // 未完了→完了の時のみ成功フィードバックを発生させる
      !oldValue && newValue
    }
  }
}
```

TODO完了時は、`item.isCompleted`の値を直接triggerとして使っている。ただしここで工夫したのが、クロージャの部分だ。`oldValue`（変更前）と`newValue`（変更後）を比較して、`!oldValue && newValue`の場合、つまり「未完了から完了に変わった時だけ」振動するようにした。

これによって、間違って完了したTODOを未完了に戻す時は振動せず、本当にタスクを完了した時だけ.successの振動が発生するようになった。

### まとめ

今回はDaily Doの1.3.0で触覚フィードバックを追加した告知および実装方法を紹介しました。ぜひDaily Doも使ってみてください。
