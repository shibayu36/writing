---
Title: レビュータイムの導入・消滅・再導入
Category:
- tech
Date: 2014-03-13T20:44:28+09:00
URL: https://blog.shibayu36.org/entry/2014/03/13/204428
EditURL: https://blog.hatena.ne.jp/shiba_yu36/shibayu36.hatenablog.com/atom/entry/12921228815719889949
---

今日こんなかんじの会話があって、レビュータイム導入した時のことを思い出したので、適当に書こうと思う。

[https://twitter.com/hisaichi5518/status/443913640706457600:embed#ひさいちレビュー、必ず通すみたいなの良いのか悪いのか]
[https://twitter.com/shiba_yu36/status/443914854483517440:embed#@hisaichi5518 マジレスすると、そのような体制にしておくとスケールしないので、最初の段階では必ず通すというルールにしつつ、他の人がレビューしても大丈夫に出来るように、レビューの練習を同時にしていってもらうとしないといけなさそう]
[https://twitter.com/shiba_yu36/status/443915709718876160:embed#@hisaichi5518 今のチームで新人が入った時は、レビュータイムというのを必ず設けてその時間には最低限どれか一つレビューするというのをやってもらってる。でも慣れるまではこれまでチームにいる人がレビューしないとmergeしないということにしてる。]
[https://twitter.com/shiba_yu36/status/443915862081159168:embed#@hisaichi5518 そうすると同時に新人とベテランがレビューするので、こういうレビューの仕方をすればいいのかという教育にもなるんじゃないかと思ってる]
[https://twitter.com/shiba_yu36/status/443945574694674432:embed#@hisaichi5518 なんでレビュータイム設けてるかというと、そのほうが新人でもコードレビューに参加する障壁を減らすためでした。うちでは全レビューは負担が大きすぎるけど、そういうの設けないと自分がやっていいのかなっておどおどしてしまうと思うのでって感じ。]

* レビュータイムとは
　レビュータイムというのは、ある時間でレビュー依頼になっているものを最低一人一つレビューする時間のこと。

昔YAPCでonishiさんの発表の中でも少しだけ言及されている。
<iframe src="http://www.slideshare.net/slideshow/embed_code/26402494?startSlide=38" width="427" height="356" frameborder="0" marginwidth="0" marginheight="0" scrolling="no" style="border:1px solid #CCC; border-width:1px 1px 0; margin-bottom:5px; max-width: 100%;" allowfullscreen> </iframe> <div style="margin-bottom:5px"> <strong> <a href="https://www.slideshare.net/onishi/hatena-blogdevelopmentflow" title="Hatena blogdevelopmentflow" target="_blank">Hatena blogdevelopmentflow</a> </strong> from <strong><a href="http://www.slideshare.net/onishi" target="_blank">Yasuhiro Onishi</a></strong> </div>

* レビュータイムの最初の導入
　レビュータイム導入以前は、チームにいるベテランの人がほとんどのコードのレビューを行うという状態になっていた。その結果、レビューがあまりにも負担になってしまっていて、ベテランがコードを書けないという状態になってしまっていた。実際そのころは僕自身もレビューをあんまりできていなかった。

　なんとなくこのままじゃいけないなと思って、この問題を解決しようといろいろ考えてた。まずなんでベテラン以外がレビューしないのかなと思っていろいろ考えてみると
- ベテランは自分がコードに一番詳しいので仕方なくレビューをする
- それ以外の人は自分はベテランよりはコードに詳しくないと思って、レビューをためらう
という状況になっているように感じた。

　とはいえ、結局レビューしてみないといろいろ詳しくならないだろうし、結局一人がレビューしまくるという体制だとどこかで無理が来るだろうと思ったので、じゃあレビュータイムという「仕組み」を導入して、みんなでレビュー出来る体制をやってみようと考えた。
- 昼休みが終わったあと一人最低 1 Pull Requestをレビューする
- 自分がその部分にあまりにも詳しくなかったら、詳しそうな人にもレビューをお願いする

　結果として
- レビューの偏りは前より減った
- レビュワーのコードの詳しさのばらつきによるレビュー精度の低下みたいなのは懸念していたが、特に問題になるほど精度が落ちることはなかった
- レビューによって自分が関わったコード以外も少しずつ詳しくなっていった
という状況になった。問題の解決としてはそこそこうまく機能したかなと思う。


* レビュータイムの消滅
　導入後数ヶ月くらいして面白いことになった。それはレビュータイム以外の時間で、チームメンバーで少し手が空いた人が積極的にレビューを行うという状態になった。また反対に昼休み終わったあとにレビューをするということをそんなにしなくなっていった。それでもレビューが誰かに偏るということや、レビューが溜まり続けるということは無かった。

　僕自身は導入しようと思った時にこういう状況になるとはあまり思ってなかった。けれど実際にはこのような状況になった。

　なんとなくこれをみて「仕組み」っていうのはうまく回ると、チームの「文化」になって、「仕組み」自体の役割を終えることもあるのだなと感じた。非常に興味深い。

　こうしてレビュータイムは消滅した。


* レビュータイムの再導入
　その後また数ヶ月くらいたって、今度は新しい人がチームにジョインした。そうするとまた新しい人がレビューをためらうという問題が発生した。

　このためらいをなくすようにするため、もう一度レビュータイム導入することになった。その時はまだ新しい人はレビューをすること自体に慣れていなかったので、昔のレビュータイムの仕組みにちょっとだけルールを追加してやってみた。
- レビューの時間は一人一つ必ずレビューする
- 新しく入った人がレビューしたものは必ずこれまでいた人も同時にレビューする

　新しく入った人がレビューしたものは、必ずこれまでいた人もレビューを行うようにした理由は、同じものを一緒にレビューすることでどうやってレビューするのかという部分を勉強してもらえるのではないかと思ったからだ。まだ導入してそんなに時間は経ってないので、これがうまく行ったかどうかはよく分かっていないが、レビューのためらいをなくすということと、レビューのやり方に慣れてもらうという観点ではある程度うまく行くのではないかと思っている。


* 感想
　こういうことがあって、仕組みは単に導入していくのではなくてうまく文化にしていけるようにしていけると、チームとしてもうまく回るのかもしれないと思った。文化を醸成する上でうまく機能してくれる仕組みをきちんと考えていきたい。

　また、昔は別のところでいろいろ仕組みを導入するということをやった結果、その仕組みの目的が忘れられて、仕組み自体に縛られてただやらされているだけということになったことがあった。実際には目的を見失わず、その目的が他で達成できたならもう仕組み自体も破棄するとか、また似た問題が起こったら少しだけ仕組みを変えたりしながら再導入するとか、ある程度柔軟にやっていかないといけないなと感じた。

　結構いろいろ考えることはあるけど、少なくとも僕はチーム内にいるメンバーになんの助けもなく、「なんでレビューしないの？意識低いの？」みたいな圧力をかけてなんとかするというのが好きじゃない。なので、こういう風に最初の方はうまく仕組みでヘルプを出して、ためらいとか障壁がなくなるようにサポートするようにしていきたい。
